# Python and Sigstore

<blockquote>
  <center>This critical role would not be possible without funding from the <a href="https://alpha-omega.dev">Alpha-Omega project</a>. Massive thank-you to Alpha-Omega for investing in the security of the Python ecosystem!</center>
</blockquote>

<div class="row">
<div class="col-9 col-sm-12">
<p><a href="https://sigstore.dev">Sigstore</a> is a digital signing method that has been <a href="https://python.org/downloads/metadata/sigstore">used by CPython since 3.11.0</a>
which focuses on ergonomics and uses <a href="https://docs.sigstore.dev/#how-sigstore-works">short-lived keys with strongly-bound human-readable identities
via OpenID Connect</a>.</p>
<p>CPython also provides digital signatures using PGP and has been doing so for much longer. Below is a diagram showing the current state of affairs:</p>
</div>
<div class="col-3 hidden-lg">
<center>
<img src="https://github.com/sigstore.png" style="max-width: 100%;">
</center>
</div>
</div>

<div>
<center>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-0.5 -0.5 811 241"  width="811px" style="max-width:100%;max-height:241px;"><defs/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="7w4lrlHi3LRZonjHD107-41"><g><rect x="580" y="60" width="230" height="120" fill="#f5f5f5" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 67px; margin-left: 581px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #333; "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font>Distro (Offline?)</font>    </div></div></div></foreignObject><text x="695" y="79" fill="#333" font-family="monospace" font-size="12px" text-anchor="middle">Distro (Offline?)    </text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-42"><g><rect x="350" y="0" width="140" height="240" fill="#f5f5f5" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 7px; margin-left: 351px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #333; "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font>python.org</font></div></div></div></foreignObject><text x="420" y="19" fill="#333" font-family="monospace" font-size="12px" text-anchor="middle">python.org</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-43"><g><rect x="90" y="60" width="240" height="120" fill="#f5f5f5" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 67px; margin-left: 91px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #333; "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font>GitHub</font></div></div></div></foreignObject><text x="210" y="79" fill="#333" font-family="monospace" font-size="12px" text-anchor="middle">GitHub</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-44"><g><path d="M 140 170 L 140 210 L 349.9 210" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 356.65 210 L 347.65 214.5 L 349.9 210 L 347.65 205.5 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-45"><g><path d="M 40 90 L 40 80.1" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 40 73.35 L 44.5 82.35 L 40 80.1 L 35.5 82.35 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-46"><g><path d="M 40 130 L 280.5 130.5 L 509.9 130.02" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 516.65 130.01 L 507.66 134.53 L 509.9 130.02 L 507.64 125.53 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-47"><g><rect x="360" y="90" width="120" height="80" fill="rgb(255, 255, 255)" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 130px; margin-left: 361px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Source Code (tar.gz)</div></div></div></foreignObject><text x="420" y="134" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Source Code (tar.gz)</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-48"><g><path d="M 480 50 L 560 50 L 560 79.9" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 560 86.65 L 555.5 77.65 L 560 79.9 L 564.5 77.65 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-49"><g><path d="M 480 50 L 760 50 L 760 79.9" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 760 86.65 L 755.5 77.65 L 760 79.9 L 764.5 77.65 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-50"><g><rect x="360" y="30" width="120" height="40" fill="#d5e8d4" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 50px; margin-left: 361px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">PGP Signature</div></div></div></foreignObject><text x="420" y="54" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">PGP Signature</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-51"><g><path d="M 480 210 L 560 210 L 560 198.24" fill="none" stroke="#666" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 560 192.24 L 564 200.24 L 560 198.24 L 556 200.24 Z" fill="#666" stroke="#666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-52"><g><rect x="360" y="190" width="120" height="40" fill="#dae8fc" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 210px; margin-left: 361px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Sigstore Bundle<br />...@python.org</div></div></div></foreignObject><text x="420" y="214" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Sigstore Bundle...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-53"><g><rect x="200" y="90" width="120" height="80" fill="rgb(255, 255, 255)" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 130px; margin-left: 201px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div>CPython<br />Release</div><div>Infra</div></div></div></div></foreignObject><text x="260" y="134" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">CPython...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-54"><g><path d="M 700 130 L 709.9 130" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 716.65 130 L 707.65 134.5 L 709.9 130 L 707.65 125.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-55"><g><rect x="620" y="90" width="80" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 130px; margin-left: 621px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Distro<br />Package<br />(deb, rpm)</div></div></div></foreignObject><text x="660" y="134" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Distro...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-56"><g><path d="M 600 130 L 609.9 130" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 616.65 130 L 607.65 134.5 L 609.9 130 L 607.65 125.5 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-57"><g><rect x="520" y="90" width="80" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 130px; margin-left: 521px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Distro<br />Build<br />Infra</div></div></div></foreignObject><text x="560" y="134" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Distro...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-58"><g><path d="M 80 50 L 349.9 50" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 356.65 50 L 347.65 54.5 L 349.9 50 L 347.65 45.5 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-59"><g><rect x="0" y="30" width="80" height="40" fill="#d5e8d4" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 50px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">PGP Keys</div></div></div></foreignObject><text x="40" y="54" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">PGP Keys</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-60"><g><rect x="100" y="90" width="80" height="80" fill="#dae8fc" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 130px; margin-left: 101px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Accounts (GitHub, Gmail)</div></div></div></foreignObject><text x="140" y="134" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Accounts (Git...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-61"><g><path d="M 10 170 C 10 138 10 122 40 122 C 20 122 20 90 40 90 C 60 90 60 122 40 122 C 70 122 70 138 70 170 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 130px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><font><br /></font></div><div><font><br /></font></div><div><font><br /></font></div><div><font>Release</font></div><font>Manager</font></div></div></div></foreignObject><text x="40" y="134" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">ReleaseMan...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-62"><g><rect x="720" y="90" width="80" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 130px; margin-left: 721px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Rebuild from source</div></div></div></foreignObject><text x="760" y="134" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Rebuild from...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-63"><g><rect x="580" y="195" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 78px; height: 1px; padding-top: 210px; margin-left: 580px;"><div style="box-sizing: border-box; font-size: 0px; text-align: right;" data-drawio-colors="color: #000; "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font>Not used for verification<br /></font></div></div></div></foreignObject><text x="658" y="214" fill="#000" font-family="monospace" font-size="12px" text-anchor="end">Not used for...</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
<br>
<small><i>CPython offers two verification methods: PGP and Sigstore. Verifiers choose which method to use.</i></small>
</center>
</div>

From this diagram you can see the two "sources" of identity provided by PGP and Sigstore both link back to [release managers](https://devguide.python.org/versions/#supported-versions). PGP relies on private keys which
are maintained and protected by individual release managers to create signatures of artifacts. Sigstore uses third-parties which support OpenID Connect such as GitHub
and Google to bind a human-readable identity like "`thomas@python.org`" to a signing certificate and signature that can be later verified.

## Why Sigstore?

The problem is that securely maintaining PGP private keys is not an easy task and the burden rests on volunteers for a minimum of
7 years (1 year of pre-releases then 5 years of bug and security fixes across *at least two* consecutive releases). Contrast that experience to
Sigstore where release managers only need to click a button to OAuth sign-in during the release process.

Sigstore externalizes the operational burden of maintaining long-lived signing keys from individual volunteers to teams of people
who run an identity platform professionally and the public-good code-signing certificate authority [Fulcio](https://github.com/sigstore/fulcio). This seems like a pretty good trade-off, considering we
already trust these platforms' identity management teams for things like GitHub accounts.

For this reason, I've [authored PEP 761](https://peps.python.org/pep-0761/) providing a deprecation and discontinuance plan of PGP signatures for CPython artifacts.
You can [join the discussion of this PEP](https://discuss.python.org/t/pep-761-deprecating-pgp-signatures-for-cpython-artifacts/67180) on discuss.python.org.
Big thank-you to [Hugo van Kemenade](https://github.com/hugovk), the release manager for Python 3.14 for sponsoring my first PEP and helping me with the process
and thanks to [William Woodruff](github.com/woodruffw) for reviewing the PEP draft and explaining the nitty-gritty details of Sigstore.

This PEP deprecates the expectation that future CPython releases will provide PGP signatures
and sets a timeline for discontinuance (Python 3.14) and a mechanism for that timeline to be extended
by a vote of the Steering Council, if necessary.

## What do verifiers need?

Signatures are only useful if they are verified, so we must weigh the needs of verifiers!

CPython's expected downstream verifiers are primarily "distributions" of CPython,
such as through a Linux distro (Debian, Fedora, Gentoo, etc) or in a container image. There are other distributions of Python such as
[pyenv](https://github.com/pyenv/pyenv) and [python-build-standalone](https://github.com/indygreg/python-build-standalone).

These users of CPython's source code are great places to verify signatures, as they're likely to be high value targets themselves
and can provide a consistent stream of verifications. If any one signature verification were to fail, it would signal that something is wrong
with upstream CPython artifacts or python.org and would likely be investigated and remediated quickly.

This further constrains attackers looking to affect CPython downstream users,
as compromising python.org would no longer be enough. Instead, attackers would need
to compromise the build infrastructure or CPython source code.

From discussions, the requirements that I've gathered from verifiers are:

* Need a tool for verification that can be packaged by distros. The recommended tool for verifying
  with a CLI is either [Cosign](https://github.com/sigstore/cosign/) or [sigstore-python](https://github.com/sigstore/sigstore-python/), both of which have challenges for Linux distro packagers.
* OS packages would require Cosign to be packaged in those OS package managers. This isn't trivial as it requires the Go toolchain to build.
* Docker and other container images want verification tools to be available at the OS level.
  Needing to pull these externally (from Cosign's GitHub releases) would require multi-stage builds which they want to avoid if possible.
  Today Cosign is [available in Alpine](https://pkgs.alpinelinux.org/package/edge/community/x86/cosign), but not yet in Debian ([but there is the beginnings of support](https://salsa.debian.org/go-team/packages/cosign)), Gentoo, or Fedora.
* Offline verification is important. Many package ecosystems ship the signatures inside the packages to enable "build from source" (such as Gentoo), and there's no guarantee that
  the package is being built online. It's okay that revocation or root of trust updates can't happen when offline. Cosign and other Sigstore verification tools support offline verification if the root of trust is "bundled" as a file locally.
* Online periodic updates to revocations and root of trust. Cosign and other Sigstore verifiers supports this use-case as the default behavior.

Overall, the availability of Cosign in OS package managers appears to be the biggest blocker to
see adoption for verifying CPython's Sigstore signatures.

## Why adopt a new signature method?

So why have CPython's Sigstore signatures not seen adoption despite being available for multiple years?
Here's a short list of self-reinforcing reasons:

* Verifiers don't *need* to adopt the new signature method (Sigstore), because the existing one (PGP) works and there's no expectation for discontinuance.
* Signers can't migrate away from the old signature method because there's apparent demand from verifiers for the old signature method.
* Verifiers don't try or test the new signature method, so the maintainers of signature tooling can't learn about or improve verifier use-cases.
* Concurrently supporting multiple signature methods is more work for both signers and verifiers.
* There are fewer available signatures using the new signing method, so the value of adopting the method as a verifier is less ([but maybe this will change soon](#many-more-signatures-are-coming)?).

Keep in mind that **almost everyone** involved in the above scenarios are volunteers.
Doing work to adopt a new process when existing processes are working can feel like "busy-work",
but I don't think that's the case for Sigstore.

Sigstore's benefits for ergonomics paired with its ability to use [workload identity](#workload-identity)
are two stand-out features compared to PGP. Workload identity being extra
important now that many projects are moving to hosted build infrastructure for releases.

## Workload Identity

Sigstore supporting workload identity means that release manager accounts can no
longer be hijacked to produce bad signatures. Artifacts get signed by the build infrastructure provider directly:

<div>
<center>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="801px" viewBox="-0.5 -0.5 801 181" style="max-width:100%;max-height:181px"><defs/><rect fill="#fff" width="100%" height="100%" x="0" y="0"/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="7w4lrlHi3LRZonjHD107-24"><g><rect x="570" y="0" width="230" height="120" fill="#f5f5f5" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 7px; margin-left: 571px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #333; "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font>Distro (Offline?)</font></div></div></div></foreignObject><text x="685" y="19" fill="#333" font-family="monospace" font-size="12px" text-anchor="middle">Distro (Offline?)</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-25"><g><rect x="340" y="0" width="140" height="180" fill="#f5f5f5" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 7px; margin-left: 341px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #333; "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font>python.org</font></div></div></div></foreignObject><text x="410" y="19" fill="#333" font-family="monospace" font-size="12px" text-anchor="middle">python.org</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-26"><g><rect x="80" y="0" width="240" height="120" fill="#f5f5f5" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 7px; margin-left: 81px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: #333; "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font>GitHub</font></div></div></div></foreignObject><text x="200" y="19" fill="#333" font-family="monospace" font-size="12px" text-anchor="middle">GitHub</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-27"><g><path d="M 250 110 L 250 150 L 339.9 150" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 346.65 150 L 337.65 154.5 L 339.9 150 L 337.65 145.5 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-28"><g><path d="M 30 70 L 270.5 70.5 L 499.9 70.02" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 506.65 70.01 L 497.66 74.53 L 499.9 70.02 L 497.64 65.53 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-29"><g><rect x="350" y="30" width="120" height="80" fill="rgb(255, 255, 255)" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 70px; margin-left: 351px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Source Code (tar.gz)</div></div></div></foreignObject><text x="410" y="74" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Source Code (tar.gz)</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-30"><g><path d="M 470 150 L 550 150 L 550 120.1" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 550 113.35 L 554.5 122.35 L 550 120.1 L 545.5 122.35 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-31"><g><path d="M 470 150 L 750 150 L 750 120.1" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 750 113.35 L 754.5 122.35 L 750 120.1 L 745.5 122.35 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-32"><g><rect x="350" y="130" width="120" height="40" fill="#dae8fc" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 150px; margin-left: 351px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Sigstore Bundle<br />python/release</div></div></div></foreignObject><text x="410" y="154" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Sigstore Bundle...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-33"><g><rect x="190" y="30" width="120" height="80" fill="#dae8fc" stroke="#000" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 70px; margin-left: 191px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div>CPython<br />Release</div><div>Infra</div></div></div></div></foreignObject><text x="250" y="74" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">CPython...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-34"><g><path d="M 690 70 L 699.9 70" fill="none" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 706.65 70 L 697.65 74.5 L 699.9 70 L 697.65 65.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-35"><g><rect x="610" y="30" width="80" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 70px; margin-left: 611px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Distro<br />Package<br />(deb, rpm)</div></div></div></foreignObject><text x="650" y="74" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Distro...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-36"><g><path d="M 590 70 L 599.9 70" fill="none" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 606.65 70 L 597.65 74.5 L 599.9 70 L 597.65 65.5 Z" fill="#000" stroke="#000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-37"><g><rect x="510" y="30" width="80" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 70px; margin-left: 511px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Distro<br />Build<br />Infra</div></div></div></foreignObject><text x="550" y="74" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Distro...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-38"><g><rect x="90" y="30" width="80" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 70px; margin-left: 91px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Accounts (GitHub, Gmail)</div></div></div></foreignObject><text x="130" y="74" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Accounts (Git...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-39"><g><path d="M 0 110 C 0 78 0 62 30 62 C 10 62 10 30 30 30 C 50 30 50 62 30 62 C 60 62 60 78 60 110 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 70px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><font><br /></font></div><div><font><br /></font></div><div><font><br /></font></div><div><font>Release</font></div><font>Manager</font></div></div></div></foreignObject><text x="30" y="74" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">ReleaseMan...</text></switch></g></g></g><g data-cell-id="7w4lrlHi3LRZonjHD107-40"><g><rect x="710" y="30" width="80" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 70px; margin-left: 711px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: monospace; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Rebuild from source</div></div></div></foreignObject><text x="750" y="74" fill="rgb(0, 0, 0)" font-family="monospace" font-size="12px" text-anchor="middle">Rebuild from...</text></switch></g></g></g></g></g></g></svg><br>
<small><i>Workload identity: verify artifacts came from CPython release infra</i></small>
</center>
</div>

Switching to workload identity also means downstream verifiers no longer need to
make changes when new release managers join the project, the expected identity would *always* be `gh/python/release-tools/...`.

We still have a ways to go to adopt workload identity for CPython because our macOS and Windows release processes don't use hosted build platforms that support OpenID Connect and Sigstore.
That means that for now we'll keep using release manager identities.

But this future may not be far off for Python packages hosted on PyPI...

## Many more signatures are coming!

[William Woodruff and the team at Trail of Bits](https://blog.trailofbits.com/2024/10/01/securing-the-software-supply-chain-with-the-slsa-framework/)
have authored [PEP 740](https://peps.python.org/pep-0740/#provenance-objects) which is provisionally accepted. The PEP
specifies how attestations that can be verified by PyPI (like Sigstore) using workload identities specified
with the secure publishing feature "[Trusted Publishers](https://packaging.python.org/en/latest/guides/publishing-package-distribution-releases-using-github-actions-ci-cd-workflows/)"
and then served alongside artifacts on PyPI.

There's a _lot_ more to this story (*but it's not for me to tell*). Given Trusted Publishers' success, there clearly are exciting times are ahead.
[Subscribe to the PyPI blog](https://blog.pypi.org/) to learn more once the project is complete.

That's all for this post! 👋 If you're interested in more you can read [the last report](https://sethmlarson.dev/pycon-taiwan-2024).
